## Kubernetes集群基本概念 

kubernetes简称k8s。kubernetes官网：https://kubernetes.io
在k8s官网的首页有着如下一句话。Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications.它的大致意思是说kubernetes是一个开源的系统，它主要用于自动部署、扩容、缩容和管理容器应用。

除此之外，还有着这样一段描述：It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.大致意思是说kubernetes将诸多应用的容器分为若干个逻辑单元以便于管理和发现。Kubernetes拥有着Google高负载生产环境的15年经验。kubernetes起源于Google内部平台的一个框架Borg。Borg在Google内部已经使用十多年，它的稳定性和性能是毋庸置疑的。所以，在Borg的基础之上诞生了Kubernetes，Kubernetes的性能还有各功能肯定是没话说的，而且kubernetes结合了社区的优秀思想和实践。它天生就注定着有一个非常好的开始，有一个非常高的起步。它出现的短短几年就已经横扫各大容器集群系统，逐渐的从流行到当下的垄断。作为一个IT从业人员，无论你是运维还是开发，现在还不去学Kubernetes，不知道kubernetes，注定你已经落伍了。可能大家对于kubernetes还是不太了解，单纯的说k8s是一个框架一个容器系统，是用来管理容器的，可能太过于含糊笼统，理解的并不是非常的清晰。

下面来给大家介绍一下k8s的一些概念、功能和组件。k8s最核心的组件是service，也就是服务。我们并不需要太过于关注kubernetes里面是如何工作的，我们只需要关心k8s给我们提供什么样的service就可以了。在学习容器时，通过一个镜像或者通过自己写的dockerfile创建了一个容器，容器里面跑了一个或多个服务，其实这些在容器当中运行的服务或者应用就是在k8s中的service。只不过kubernetes中的service他是比docker的容器还要更加的复杂，因为他包含了其它的一些概念，也就是说这个service不仅仅是一个单独的容器，它还存在一些其它的东西，比如pod。而service是由Pod组成的，而Pod是由容器组成的。提供Service的是容器，为了保证Service的高可用，提供Service的容器不能只有一个，它需要一组，这一组容器我们把它叫做Pod。而Service本身要使用它的时候，我们只需要拿到一个IP和Port就可以了。多个Service之间是可以进行互相通信的。比如service-a提供了web服务，service-b提供了db服务。这两个service之间是可以进行互信的。这样就形成了一个整体，可以去跑一个web网站了。

为了实现service和pod之间的关联，pod里面有容器，多个容器组成了一个pod，pod又组成了service。pod和service是如何关联的呢？其实它们之间是通过一个叫做label的标签关联起来的。用Label可以给pod打标记，比如有N个pod，这N个pod里面拥有着同样的一个标签叫做mysql，那么这些pod他们组成了一个service，也就是说一个service可以由多个pod。那么pod运行在哪里呢？我们前面提到，pod是容器，容器肯定是运行在机器上，无论是物理机还是虚拟机还是云主机。Pod是运行在Node上的，我们把物理机、虚拟机、云主机叫做Node。通常情况下一个Node上可以运行几百个Pod，每个Pod里面运行着一个特殊的容器，叫做Pause。Pause和普通的容器不太一样，它拥有一个很重要的功能，那就是用来共享网络栈和Volume挂载卷，因此同一个Pod内的业务容器之间的通信和数据交换更为高效。

在集群管理方面，kubernetes将集群中的机器划分为一个master节点，一群工作组节点node。我们前面说到了node上面运行着pod，这是工作节点，除了工作节点外还有一个管理他们的节点叫做master节点。master节点上运行着kube-apiserver、kube-controller-manager和kube-scheduler三个重要组件，这三个重要组件实现了资源的管理、Pod调度、弹性伸缩、安全控制、系统监控、纠错等功能。Node是一个工作节点，它运行应用程序提供服务，Node上最小的单元就是Pod。Node上运行着kubernetes的Kubelet和kube-proxy服务，他们负责Pod的创建、启动、监控、重启、销毁以及实现负载均衡。

在集群管理方面，kubernetes有两大决策。一个叫做管理节点master，一个叫做工作节点node。管理节点上有三个服务，分别是kube-apiserver、kube-controller-manager和kube-scheduler。他们分别实现了资源的管理，Pod调度、弹性伸缩、安全控制、系统纠结、监控等等功能。而Node节点上很明显运行的是Pod。在Node节点上需要kubelet，kubelet是用来对Pod进行管理的，比如创建Pod，启动Pod，监控Pod，重启Pod，销毁Pod，还有一个叫做kube-proxy，这是一个代理，用来实现负载均衡的。多个Pod组合在一起形成了一个Service。Service提供服务时只有一个出口IP和Port。怎么把这么多的Pod组和在一起调度呢？就是用kube-proxy。

